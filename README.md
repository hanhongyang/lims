
# LIMS 系统核心业务功能说明书

## 第一部分：基础数据模块

> **定位**：系统的“字典”与“规则引擎”。此处定义的数据将直接决定化验室流程如何流转、报告如何生成以及判定标准是什么。

### 1.1 检测体系定义

这是实验室最核心的元数据，定义了“测什么”和“怎么测”。

* **检测项目管理**
* **功能**：定义实验室可开展的所有检测参数（如：蛋白、脂肪、黄曲霉毒素、布病抗体等）。设置标签可以区分不同类型的项目。配置各个部门的关联设备及地点。
* **关键属性**：项目编码、项目名称、单位、检测周期、保留小数位数、所属实验室部门。


* **检测特性**
* **功能**：定义项目的不同特性（如：≥100g/kg、≤12.0%）。
* **关键属性**：特性描述、第一上限、第一下限、规格上限、规格下限、计量单位。


* **项目特性对应**
* **功能**：检测项目和项目特性的对应关系。



* **人员对应项目**
* **功能**：管理实验员的技能矩阵。
* **逻辑**：建立“人员-检测项目”对照表，系统在分配任务时，只能将任务分配给具备该项目资质的实验员，确保合规性。


* **物料档案**
* **功能**：定义待检样品的物料基础信息。可以根据类型和标签来区分。支持 SAP 同步。


* **物料项目标准**
* **功能**：配置物料和项目的对应关系。决定物料可以做哪些检测项目。


### 1.3 实验室配置

* **工作日配置**：定义实验室的工作日历，用于系统自动计算预计出送检期限。

* **通讯方式**：配置各个牧场的联系人、电话、邮箱、收报告类型。
---

## 第二部分：中心化验室业务 


### 2.1 委托登记 

系统根据不同的业务场景，设计了独立的委托入口，以适应不同的字段需求。

* **血样委托**：针对牧场牛只血样检测（如布病、口蹄疫、生化、早孕）。重点记录牛号、管号信息。
* **饲料委托**：针对原料（豆粕、玉米）和成品饲料检测。重点记录物料信息、检测项目、检测方法、样品信息。
* **PCR 委托**：分子生物学检测，检测项目：八联、五联、七联、单联金葡、单联支原体、单联无乳。
* **外部送样登记**：处理第三方的检测需求。

**核心能力**：
* **编码生成**：委托保存后，系统生成委托单编码，打印委托单。
* **批量导入**：支持 Excel 模板导入，快速创建大批量委托单。
* **委托单打印**

### 2.2 样品接收 

* **功能**：提交后的委托单，检测中心可以在该页面确认接收。可以修改委托单信息或退回。
* **流程**：
1. 扫描委托单上的条形码。
2. **核对状态**：确认样品是否存在破损、量不足等拒收情况。
3. **签收**：系统状态由“待受理”变更为“已受理”，并生成具体的实验室内部编号（Lab No.）。


* **分包/流转**：根据检测项目对应的人员，自动将样品流转到对应人员的检测任务种。

### 2.3 任务分配 

* **功能**：实验室主管将已接收的样品分配给具体的实验员。
* **饲料**：分为化学法、初水分两个列表。点开始化验打开化验单。
* **PCR**：
* **疾病**：
* **早孕**：
* **生化**：
* **近红外国内**：


### 2.4 实验检测与结果录入

这是后端逻辑最复杂的部分 

* **数据录入**：
* **手工录入**：实验员在 Web 端填报结果。
* **Excel 导入**：支持下载录入模板，线下填写后上传。
* **仪器采集**：(部分实现) 通过接口直接读取联网设备的数据。


* **自动计算与修约**：
* 后端根据 `LabtestMethodsFormula`（公式配置）自动计算最终结果。
* 根据基础数据中的“保留小数位数”进行数值修约。


* **自动判定**：
* 将结果与 `Standard`（判定标准）比对，自动标记为“合格”、“不合格”或“阴性/阳性”。


* **异常处理**：
* 如果结果超标，系统会触发复检提醒或异常流程。



### 2.5 报告管理 

* **报告生成**：
* 支持按委托单合并生成报告，也支持按样品生成。
* 后端使用 PDF 引擎或 Excel 引擎生成最终文件。


* **审核流程**：
* **三级审核机制**：录入人提交 -> 审核人核对（Review） -> 批准人签发（Approve）。
* 电子签名：审核通过后自动加盖电子签章。


* **报告分发**：
* 支持在线预览、下载 PDF。
* (扩展功能) 结果回传至 SAP 系统或通过钉钉推送给委托人。



### 2.6 样品结算 

* **功能**：针对需要内部核算或外部收费的样品。
* **逻辑**：根据检测项目单价 × 样品数量，生成结算清单或发票申请单。

